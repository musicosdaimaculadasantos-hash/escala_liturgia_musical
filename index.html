<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Par√≥quia Imaculado Cora√ß√£o de Maria - Oficial</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Lora:ital,wght@0,400;0,700;1,400&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">

    <style>
        :root {
            --header: #14532d;
            --accent: #22c55e;
            --bg-main: #f0fdf4;
        }

        body { font-family: 'Lora', serif; transition: background-color 0.5s ease; background-color: #f5f5f5; }
        h1, h2, h3, .font-cinzel { font-family: 'Cinzel', serif; }
        
        /* Classes Lit√∫rgicas */
        .lit-verde { --bg-main: #f0fdf4; --header: #14532d; --accent: #22c55e; }
        .lit-roxo { --bg-main: #faf5ff; --header: #4c1d95; --accent: #a855f7; }
        .lit-branco { --bg-main: #fffcf0; --header: #78350f; --accent: #d4af37; }
        .lit-vermelho { --bg-main: #fef2f2; --header: #7f1d1d; --accent: #ef4444; }

        .religious-border { border: 6px double var(--header); outline: 2px solid var(--accent); }
        
        .tag-grupo {
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: bold;
            text-transform: uppercase;
            font-size: 0.65rem;
            display: inline-block;
            min-width: 90px;
            text-align: center;
            border: 1px solid rgba(0,0,0,0.1);
        }

        /* Cores dos Grupos */
        .bg-marcio { background-color: #0f766e !important; color: #fafee2 !important; }
        .bg-marco { background-color: #0369a1 !important; color: white !important; }
        .bg-casais { background-color: #1e40af !important; color: white !important; }
        .bg-vozes { background-color: #991b1b !important; color: white !important; }
        .bg-jovens { background-color: #d97706 !important; color: white !important; }
        .bg-fatima { background-color: #166534 !important; color: white !important; }
        .bg-adefinir { background-color: #78716c !important; color: white !important; }
        .bg-eac { background-color: #701a75 !important; color: white !important; }

        .tab-active { background-color: var(--header) !important; color: white !important; }
        
        .loading-pulse { animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { opacity: 0.5; } 50% { opacity: 1; } 100% { opacity: 0.5; } }

        @media print {
            .no-print { display: none !important; }
            body { background: white !important; padding: 0; }
            .religious-border { border: 2px solid #000; outline: none; margin: 0; }
            .max-w-\[1550px\] { max-width: 100% !important; border-radius: 0 !important; }
        }

        #month-tabs::-webkit-scrollbar { height: 4px; }
        #month-tabs::-webkit-scrollbar-thumb { background: #ccc; border-radius: 10px; }
    </style>
</head>
<body id="main-body" class="p-2 md:p-6 transition-colors duration-700">

    <div class="max-w-[1550px] mx-auto bg-white shadow-2xl rounded-sm religious-border overflow-hidden">
        
        <!-- HEADER -->
        <header class="bg-[var(--header)] text-white p-6 text-center border-b-4 border-[var(--accent)] transition-colors duration-500">
            <div class="flex flex-col md:flex-row justify-between items-center gap-4">
                <div class="text-center md:text-left">
                    <p class="text-xs uppercase tracking-widest opacity-80">M√™s Dedicado a:</p>
                    <p id="liturgical-name" class="text-lg font-bold font-cinzel text-[var(--accent)]">...</p>
                </div>
                
                <div>
                    <h1 class="text-2xl md:text-3xl font-bold mb-1 font-cinzel uppercase">Par√≥quia Imaculado Cora√ß√£o de Maria</h1>
                    <div id="liturgical-cycle" class="text-xs font-bold tracking-[0.2em] text-[var(--accent)] mb-2 uppercase italic">Carregando Ciclo...</div>
                    <p class="text-sm italic tracking-widest uppercase opacity-80">Escala de M√∫sica & Liturgia</p>
                </div>

                <div class="text-center md:text-right">
                    <select id="year-selector" onchange="updateYear()" class="bg-transparent border border-white/30 rounded px-2 py-1 text-white font-bold cursor-pointer hover:bg-white/10 no-print">
                        <option value="2026" class="text-black" selected>2026</option>
                        <option value="2027" class="text-black">2027</option>
                        <option value="2028" class="text-black">2028</option>
                    </select>
                    <p id="display-month-year" class="text-xl font-bold font-cinzel mt-1">Janeiro</p>
                </div>
            </div>
        </header>

        <!-- NOVO: BARRA DE SIGNIFICADO LIT√öRGICO -->
        <div id="liturgical-info-bar" class="bg-[var(--bg-main)] p-4 border-b border-stone-200 flex flex-col md:flex-row items-center gap-4 transition-colors duration-500">
            <div class="flex items-center gap-3 border-r-0 md:border-r border-stone-300 pr-0 md:pr-6">
                <div id="lit-color-circle" class="w-12 h-12 rounded-full border-4 border-white shadow-sm flex-shrink-0 bg-[var(--accent)]"></div>
                <div>
                    <p class="text-[10px] uppercase font-bold text-stone-500">Tempo Atual</p>
                    <p id="lit-tempo-nome" class="text-sm font-bold text-[var(--header)] uppercase font-cinzel">Tempo Comum</p>
                </div>
            </div>
            <div class="flex-1">
                <p class="text-[10px] uppercase font-bold text-stone-500 mb-1">Significado & Cor</p>
                <p id="lit-tempo-significado" class="text-xs text-stone-600 italic leading-relaxed">...</p>
            </div>
        </div>

        <!-- NAVEGA√á√ÉO -->
        <nav class="no-print bg-stone-100 border-b overflow-x-auto">
            <div id="month-tabs" class="flex min-w-max md:w-full justify-between"></div>
        </nav>

        <div class="p-4 md:p-8">
            <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
                
                <!-- TABELA -->
                <div class="lg:col-span-3">
                    <div class="flex justify-between items-end mb-4 border-b pb-2 border-stone-200">
                        <h2 id="current-month-title" class="text-2xl font-bold text-[var(--header)] font-cinzel uppercase">Janeiro</h2>
                        <button onclick="window.print()" class="no-print bg-stone-800 text-white text-[10px] py-1.5 px-4 rounded hover:bg-black transition-colors uppercase font-bold tracking-tighter">üñ®Ô∏è Imprimir Escala</button>
                    </div>

                    <div class="overflow-x-auto shadow-sm rounded border border-stone-200">
                        <table class="w-full border-collapse bg-white">
                            <thead class="bg-stone-50 text-[10px] uppercase text-stone-600 font-bold">
                                <tr>
                                    <th class="p-3 border-b border-r w-20">Data</th>
                                    <th class="p-3 border-b border-r text-left">Liturgia das Leituras</th>
                                    <th class="p-3 border-b border-r">S√°b (16h)</th>
                                    <th class="p-3 border-b border-r">Dom (07:30)</th>
                                    <th class="p-3 border-b border-r">Dom (09:00)</th>
                                    <th class="p-3 border-b border-r">Dom (17:00)</th>
                                    <th class="p-3 border-b">Dom (19:00)</th>
                                </tr>
                            </thead>
                            <tbody id="corpo-escala"></tbody>
                        </table>
                    </div>
                </div>

                <!-- DATAS -->
                <div class="lg:col-span-1">
                    <section class="bg-stone-50 p-4 rounded-lg border-2 border-dashed border-stone-300 min-h-[400px]">
                        <h3 class="font-cinzel font-bold text-[var(--header)] mb-4 border-b pb-2 flex items-center gap-2">
                            <span>üìÖ</span> Datas Importantes
                        </h3>
                        <div id="important-dates-list" class="space-y-3"></div>
                    </section>
                </div>
            </div>

            <!-- RODAP√â -->
            <div class="mt-12 grid grid-cols-1 md:grid-cols-2 gap-8 border-t-2 border-stone-200 pt-8">
                <div class="bg-[var(--bg-main)] p-6 rounded-lg border-l-4 border-[var(--header)] shadow-sm transition-colors duration-500">
                    <h3 class="font-cinzel font-bold text-[var(--header)] text-xl mb-4">Recomenda√ß√µes</h3>
                    <ul class="space-y-3 text-sm leading-relaxed text-stone-700">
                        <li><strong class="text-[var(--header)]">Substitui√ß√µes:</strong> O grupo deve providenciar sua pr√≥pria substitui√ß√£o com anteced√™ncia m√≠nima de 48h.</li>
                        <li><strong class="text-[var(--header)]">Ensaios:</strong> Recomenda-se ensaio do Salmo e cantos 30 min antes da celebra√ß√£o.</li>
                    </ul>
                </div>

                <div class="bg-stone-50 p-6 rounded-lg border-l-4 border-stone-400 shadow-sm">
                    <h3 class="font-cinzel font-bold text-stone-800 text-xl mb-4">Postura e T√©cnica</h3>
                    <ul class="space-y-3 text-sm leading-relaxed text-stone-700">
                        <li><strong class="text-stone-900">Som:</strong> Verificar microfones junto √† equipe de som antes da Missa.</li>
                        <li><strong class="text-stone-900">Liturgia:</strong> A m√∫sica √© parte da ora√ß√£o; prepare-se espiritualmente.</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        const mesesNomes = ["Janeiro", "Fevereiro", "Mar√ßo", "Abril", "Maio", "Junho", "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"];
        const mesLiturgicoDedicado = {
            0: "Sant√≠ssimo Nome de Jesus", 1: "Sant√≠ssima Fam√≠lia", 2: "S√£o Jos√©", 3: "Eucaristia e Esp√≠rito Santo",
            4: "Virgem Maria", 5: "Sagrado Cora√ß√£o de Jesus", 6: "Precios√≠ssimo Sangue", 7: "Voca√ß√µes",
            8: "B√≠blia", 9: "Miss√µes e Santo Ros√°rio", 10: "Fi√©is Defuntos", 11: "Advento e Nascimento"
        };

        const significadosTempos = {
            "Comum": { cor: "Verde", sig: "Tempo de esperan√ßa e crescimento. Simboliza a vida da Igreja que floresce e a caminhada di√°ria do crist√£o sob a guia do Esp√≠rito." },
            "Quaresma": { cor: "Roxo", sig: "Tempo de penit√™ncia, reflex√£o e convers√£o. Quarenta dias de prepara√ß√£o espiritual para a grande festa da P√°scoa do Senhor." },
            "P√°scoa": { cor: "Branco/Dourado", sig: "A maior festa crist√£! Celebra a vit√≥ria de Cristo sobre a morte. Tempo de imensa alegria, luz e renova√ß√£o da f√©." },
            "Advento": { cor: "Roxo", sig: "Expectativa e vigil√¢ncia. Preparamos o cora√ß√£o para a vinda do Salvador, tanto no Natal quanto em Sua vinda gloriosa no fim dos tempos." },
            "Natal": { cor: "Branco", sig: "Celebramos o mist√©rio da Encarna√ß√£o. Deus se fez homem e habitou entre n√≥s para nos salvar." },
            "Pentecostes": { cor: "Vermelho", sig: "Celebra a vinda do Esp√≠rito Santo sobre os Ap√≥stolos. Cor do fogo, da caridade e do testemunho dos m√°rtires." }
        };

        const datasOficiais = [
            {d:"01/01", t:"M√£e de Deus"}, {d:"11/01", t:"Batismo do Senhor"}, {d:"20/01", t:"Dia de S√£o Sebasti√£o"},
            {d:"03/02", t:"Dia de S√£o Br√°s"},{d:"11/02", t:"Dia de Nossa Senhora de Lourdes"}, {d:"18/02", t:"Quarta feira de Cinzas"},{d:"27/02", t:"Aniv. Sacerd√≥cio Pe Reni"},
            {d:"18/03", t:"Via Sacra"}, {d:"19/03", t:"Dia de S√£o Jos√©"}, {d:"20/03", t:"Via Sacra"},
            {d:"23/03", t:"Via Sacra"}, {d:"24/03", t:"Anivers√°rio do Pe Sebastiano"}, {d:"25/03", t:"Anuncia√ß√£o do Senhor"},
            {d:"27/03", t:"Via Sacra"}, {d:"29/03", t:"Domingo de Ramos"}, {d:"30/03", t:"Via Sacra"},
            {d:"03/04", t:"Sexta feira Santa"}, {d:"04/04", t:"Vig√≠lia Pascal"}, {d:"05/04", t:"P√°scoa"}, {d:"12/04", t:"Divina Miseric√≥rdia"}, 		    {d:"19/04", t:"Santo Expedito"},	{d:"23/04", t:"Dia de S√£o Jorge"},
            {d:"09/05", t:"Anivers√°rio do Pe Almir"}, {d:"12/05", t:"Dia de S√£o Pancr√°cio"}, {d:"13/05", t:"Dia de Nossa Senhora de F√°tima"},
            {d:"17/05", t:"Cerco de Jeric√≥ 1"}, {d:"18/05", t:"Cerco de Jeric√≥ 2"},
            {d:"19/05", t:"Cerco de Jeric√≥ 3"}, {d:"20/05", t:"Cerco de Jeric√≥ 4"},
            {d:"21/05", t:"Cerco de Jeric√≥ 5"}, {d:"22/05", t:"Cerco de Jeric√≥ 6"}, {d:"23/05", t:"Cerco de Jeric√≥ 7"},
            {d:"22/05", t:"Dia de Santa Rita de C√°ssia"}, {d:"24/05", t:"Pentecostes"}, {d:"31/05", t:"Sant√≠ssima Trindade"},
	    {d:"31/05", t:"Visita√ß√£o de Maria"},{d:"04/06", t:"Corpus Christi"},{d:"12/06", t:"Sagrado Cora√ß√£o de Jesus"} ,
            {d:"13/06", t:"Imaculado Cora√ß√£o de Maria"},{d:"13/06", t:"Dia de Santo Ant√¥nio"}, 
            {d:"24/06", t:"Dia de S√£o Jo√£o Batista"}, {d:"25/06", t:"Dia de Nossa Senhora Rainha da Paz"}, 
            {d:"27/06", t:"Dia de Nossa Senhora do Pep√©tuo Socorro"},
            {d:"29/06", t:"Dia de S√£o Pedro e S√£o Paulo"},{d:"17/06", t:"Aniv. Pe Reni"},
            {d:"11/07", t:"Dia de S√£o Bento"},{d:"13/07", t:"Dia de Nossa Senhora da Rosa M√≠stica"},
            {d:"16/07", t:"Dia de Nossa Senhora do Carmo"},{d:"26/07", t:"Dia de S√£o Joaquim e Santa Ana"},
            {d:"29/07", t:"Dia de Santa Marta"},
            {d:"01/08", t:"Dia de Santo Afonso"},{d:"02/08", t:"Aniv. Sacerd√≥cio Pe Almir"},
            {d:"06/08", t:"Transfigura√ß√£o do Senhor"}, {d:"10/08", t:"Dia de S√£o Louren√ßo"},{d:"11/08", t:"Dia de Santa Clara"},
            {d:"15/08", t:"Assun√ß√£o da Virgem Maria"},{d:"15/08", t:"Dia de Nossa Senhora Desatador dos N√≥s / Abadia"},
            {d:"08/09", t:"Nossa Senhora do Monte Serrat"},{d:"15/09", t:"Nossa Senhora das Dores / Piedade / Merc√™"} ,
            {d:"19/09", t:"Nossa Senhora La Salete"},{d:"21/09", t:"Dia de S√£o Matheus"},{d:"23/09", t:"Dia de Padre Pio"},
            {d:"26/09", t:"Dia de S√£o Cosme e Dami√£o"},{d:"27/09", t:"Dia de S√£o Vicente de Paula"},
            {d:"29/09", t:"Dia de Arcanjos Gabriel / Rafael / Miguel"},
            {d:"01/10", t:"Dia de Santa Teresinha"},  {d:"02/10", t:"Dia dos Anjos da Guarda"}, {d:"04/10", t:"Dia de S√£o Francisco"}, 
            {d:"07/10", t:"Dia de Nossa Senhora do Ros√°rio"}, {d:"08/10", t:"Dia de Nossa Senhora do Bom Parto"},
            {d:"12/10", t:"Nossa Senhora Aparecida"},  {d:"16/10", t:"Dia de Santa Edwiges"}, {d:"18/10", t:"Dia de S√£o Lucas"},
            {d:"24/10", t:"Dia de S. Ant√¥nio M. Claret"},
            {d:"01/11", t:"Dia de Todos os Santos"}, {d:"02/11", t:"Finados"}, {d:"22/11", t:"Dia de Santa Cec√≠lia"},
            {d:"25/11", t:"Dia de Santa Catarina"},{d:"27/11", t:"Dia de Nossa Senhora das Gra√ßas"},
            {d:"05/12", t:"Aniv. Sacerd√≥cio Pe Sebastiano"}, {d:"06/12", t:"Dia de S√£o Nicolau"}, 
            {d:"08/12", t:"Dia da Imaculada Concei√ß√£o"},{d:"09/12", t:"Novena Natal 1"},{d:"12/12", t:"Dia de Nossa Senhora de Guadalupe / Boa viagem"},
            {d:"11/12", t:"Novena Natal 2"}, {d:"13/12", t:"Dia de Santa Luzia"}, {d:"14/12", t:"Novena Natal 3"},
            {d:"16/12", t:"Novena Natal 4"}, {d:"18/12", t:"Novena Natal 5"}, {d:"25/12", t:"Natal"},
            {d:"26/12", t:"Dia de Santo Estev√£o"}, {d:"27/12", t:"Dia da Sagrada Fam√≠lia"}, {d:"28/12", t:"Dia dos Santos Inocentes"}

        ];

        let anoAtual = 2026;
        let mesAtualIdx = 0;
        const liturgiaCache = {};

        function atualizarCicloLiturgico(ano) {
            const resto = (ano - 2023) % 3;
            let ciclo = resto === 0 ? "Ano A" : (resto === 1 ? "Ano B" : "Ano C");
            let ev = resto === 0 ? "Mateus" : (resto === 1 ? "Marcos" : "Lucas");
            document.getElementById('liturgical-cycle').innerText = `${ciclo} ‚Äî Evangelista S√£o ${ev}`;
        }

        async function fetchLiturgiaCompleta(date) {
            const dateStr = `${date.getFullYear()}-${(date.getMonth() + 1).toString().padStart(2, '0')}-${date.getDate().toString().padStart(2, '0')}`;
            if (liturgiaCache[dateStr]) return liturgiaCache[dateStr];
            try {
                const res = await fetch(`https://liturgia.up.railway.app/?dia=${date.getDate()}&mes=${date.getMonth() + 1}&ano=${date.getFullYear()}`);
                const data = await res.json();
                const result = {
                    leitura1: data.primeiraLeitura?.referencia || "Folheto",
                    leitura2: data.segundaLeitura?.referencia || "N√£o h√°",
                    salmoRef: data.salmo?.referencia || "Salmo",
                    salmoRefrao: data.salmo?.refrao || "...",
                    evangelho: data.evangelho?.referencia || "Evangelho"
                };
                liturgiaCache[dateStr] = result; return result;
            } catch (e) { return { leitura1: "-", leitura2: "-", salmoRef: "-", salmoRefrao: "-", evangelho: "-" }; }
        }

        function getPascoa(year) {
            const a = year % 19, b = Math.floor(year / 100), c = year % 100;
            const d = Math.floor(b / 4), e = b % 4, f = Math.floor((b + 8) / 25);
            const g = Math.floor((b - f + 1) / 3), h = (19 * a + b - d - g + 15) % 30;
            const i = Math.floor(c / 4), k = c % 4, l = (32 + 2 * e + 2 * i - h - k) % 7;
            const m = Math.floor((a + 11 * h + 22 * l) / 451);
            const pMonth = Math.floor((h + l - 7 * m + 114) / 31);
            const pDay = ((h + l - 7 * m + 114) % 31) + 1;
            return new Date(year, pMonth - 1, pDay);
        }

        function getInfoLiturgica(date) {
            const time = date.getTime();
            const y = date.getFullYear();
            const pascoa = getPascoa(y);
            const cinzas = new Date(pascoa); cinzas.setDate(pascoa.getDate() - 46);
            const pentecostes = new Date(pascoa); pentecostes.setDate(pascoa.getDate() + 50);
            const natal = new Date(y, 11, 25);
            const advento = new Date(y, 11, 25 - (natal.getDay() || 7) - 21);

            if ((date.getMonth() === 11 && date.getDate() >= 25) || (date.getMonth() === 0 && date.getDate() <= 11)) 
                return { css: "lit-branco", tempo: "Natal" };
            if (time >= advento.getTime() && time < natal.getTime()) 
                return { css: "lit-roxo", tempo: "Advento" };
            if (time >= cinzas.getTime() && time < pascoa.getTime()) 
                return { css: "lit-roxo", tempo: "Quaresma" };
            if (time >= pascoa.getTime() && time < pentecostes.getTime()) 
                return { css: "lit-branco", tempo: "P√°scoa" };
            if (time === pentecostes.getTime()) 
                return { css: "lit-vermelho", tempo: "Pentecostes" };
            
            return { css: "lit-verde", tempo: "Comum" };
        }

        function getTag(name) {
            const n = name.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "").replace(/\s/g, "");
            return `<span class="tag-grupo bg-${n}">${name}</span>`;
        }

        async function render() {
            atualizarCicloLiturgico(anoAtual);
            document.getElementById('display-month-year').innerText = `${mesesNomes[mesAtualIdx]} ${anoAtual}`;
            document.getElementById('current-month-title').innerText = mesesNomes[mesAtualIdx];
            document.getElementById('liturgical-name').innerText = mesLiturgicoDedicado[mesAtualIdx];

            // Atualiza Info Bar (usa o meio do m√™s como refer√™ncia)
            const info = getInfoLiturgica(new Date(anoAtual, mesAtualIdx, 15));
            document.getElementById('main-body').className = "p-2 md:p-6 " + info.css;
            document.getElementById('lit-tempo-nome').innerText = "Tempo " + info.tempo;
            document.getElementById('lit-tempo-significado').innerText = `Cor ${significadosTempos[info.tempo].cor}: ${significadosTempos[info.tempo].sig}`;

            const tabDiv = document.getElementById('month-tabs');
            tabDiv.innerHTML = mesesNomes.map((n, i) => `
                <button onclick="mesAtualIdx=${i}; render()" class="flex-1 py-3 px-2 text-[10px] font-bold uppercase border-r border-stone-200 ${mesAtualIdx === i ? 'tab-active' : 'text-stone-500 hover:bg-stone-200'}">
                    ${n.substring(0,3)}
                </button>
            `).join('');

            const corpo = document.getElementById('corpo-escala');
            corpo.innerHTML = '';
            let d = new Date(anoAtual, mesAtualIdx, 1);
            let domingos = [];
            while(d.getMonth() === mesAtualIdx) {
                if(d.getDay() === 0) domingos.push(new Date(d));
                d.setDate(d.getDate() + 1);
            }

            for (let i = 0; i < domingos.length; i++) {
                const dom = domingos[i];
                const sab = new Date(dom); sab.setDate(dom.getDate() - 1);
                const temp = getInfoLiturgica(dom);
                const dtFmt = (dt) => `${dt.getDate().toString().padStart(2,'0')}/${(dt.getMonth()+1).toString().padStart(2,'0')}`;
                const idLit = `lit-${dtFmt(dom).replace('/','-')}`;
                
                corpo.innerHTML += `
                    <tr class="${temp.css} border-b border-stone-200 bg-white/40">
                        <td class="p-2 border-r font-bold text-[10px] text-stone-700 bg-white/60 text-center">
                            S: ${dtFmt(sab)}<br>D: ${dtFmt(dom)}
                        </td>
                        <td class="p-2 border-r text-left align-top min-w-[180px]">
                            <div id="${idLit}" class="space-y-1 loading-pulse">
                                <div class="h-3 w-3/4 bg-stone-200 rounded"></div>
                                <div class="h-3 w-1/2 bg-stone-200 rounded"></div>
                            </div>
                        </td>
                        <td class="p-1 border-r text-center align-middle">${getTag(["M√ÅRCIO", "VOZES", "JOVENS", "MARCO", "A DEFINIR"][i % 5])}</td>
                        <td class="p-1 border-r text-center align-middle">${getTag("CASAIS")}</td>
                        <td class="p-1 border-r text-center align-middle">${getTag("F√ÅTIMA")}</td>
                        <td class="p-1 border-r text-center align-middle">${getTag(i === 2 ? "EAC" : "JOVENS")}</td>
                        <td class="p-1 text-center align-middle">${getTag(i === 1 ? "MARCO" : "VOZES")}</td>
                    </tr>
                `;

                fetchLiturgiaCompleta(dom).then(l => {
                    const el = document.getElementById(idLit);
                    if (el) {
                        el.classList.remove('loading-pulse');
                        el.innerHTML = `
                            <div class="grid grid-cols-1 gap-x-2 text-[9px] leading-tight">
                                <p class="text-stone-600"><span class="font-bold text-red-800">1¬™L:</span> ${l.leitura1} | <span class="font-bold text-red-800">Sal:</span> ${l.salmoRef}</p>
                                <p class="text-stone-600"><span class="font-bold text-red-800">2¬™L:</span> ${l.leitura2} | <span class="font-bold text-red-800">Ev:</span> ${l.evangelho}</p>
                            </div>
                            <p class="text-[9px] italic text-stone-500 mt-1 leading-tight border-t border-stone-100 pt-1">"${l.salmoRefrao}"</p>
                        `;
                    }
                });
            }

            const listDiv = document.getElementById('important-dates-list');
            const mesStr = (mesAtualIdx + 1).toString().padStart(2, '0');
            const eventosDoMes = datasOficiais.filter(item => item.d.endsWith(`/${mesStr}`))
                .sort((a, b) => parseInt(a.d.substring(0, 2)) - parseInt(b.d.substring(0, 2)));

            listDiv.innerHTML = eventosDoMes.length > 0 ? eventosDoMes.map(item => `
                <div class="p-2 bg-white border-l-4 border-[var(--header)] shadow-sm rounded-r">
                    <p class="text-[10px] font-bold text-stone-500">${item.d}</p>
                    <p class="text-[11px] text-stone-700 font-medium">${item.t}</p>
                </div>
            `).join('') : '<p class="text-[10px] italic text-stone-400 text-center py-6">Sem datas registradas.</p>';
        }

        function updateYear() {
            anoAtual = parseInt(document.getElementById('year-selector').value);
            render();
        }

        window.onload = render;
    </script>
</body>
</html>